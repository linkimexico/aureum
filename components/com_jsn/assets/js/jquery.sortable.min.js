!function(a,b,c,d){function h(b,d){this.w=a(c),this.$instance=a(b),this.options=a.extend(!0,{},g,d),this.init()}function i(a,b){if(!a)throw new TypeError("expected object, got "+typeof a);this._plugin=a,this._lists=b}var e="ontouchstart"in c;String.prototype.dot=function(){return"."+this},String.prototype.eachHas=function(a,b,c,d){var e=this,f=[],b=b||", ",c=c||" ",d=d||b,g=a.split(b);return g.forEach(function(a,b){f.push(e+c+a)}),f.join(d)},String.prototype.padLength=function(a,b){for(var c=this;c.length<b;)c=a+c;return c},String.prototype.join=function(a,b){var b="string"==typeof b?b:" ";return this+b+a},Function.prototype.setName=function(a){return Object.defineProperty(this,"name",{get:function(){return a}}),this},Function.prototype.clone=function(){var a=new Function("return "+this.toString())();for(var b in this)a[b]=this[b];return a};var f=function(){var a=c.createElement("div"),d=c.documentElement;if(!("pointerEvents"in a.style))return!1;a.style.pointerEvents="auto",a.style.pointerEvents="x",d.appendChild(a);var e=b.getComputedStyle&&"auto"===b.getComputedStyle(a,"").pointerEvents;return d.removeChild(a),!!e}(),g={listNodeName:"ol",itemNodeName:"li",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",itemBlueprintClass:"dd-item-blueprint",dragClass:"dd-dragel",handleClass:"dd-handle",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",emptyClass:"dd-empty",contentClass:"dd3-content",itemAddBtnClass:"item-add",removeBtnClass:"item-remove",itemRemoveBtnConfirmClass:"confirm-class",addBtnSelector:"",addBtnClass:"dd-new-item",editBoxClass:"dd-edit-box",inputSelector:"input, select, textarea",collapseBtnClass:"collapse",expandBtnClass:"expand",endEditBtnClass:"end-edit",itemBtnContainerClass:"dd-button-container",itemNameClass:"item-name",data:"",allowListMerging:!1,select2:{support:!1,selectWidth:"45%",params:{}},slideAnimationDuration:0,maxDepth:5,threshold:15,refuseConfirmDelay:2e3,newItemFadeIn:350,event:{onToJson:[],onParseJson:[],onSaveEditBoxInput:[],onItemDrag:[],onItemAddChildItem:[],onItemDrop:[],onItemAdded:[],onItemExpanded:[],onItemCollapsed:[],onItemRemoved:[],onItemStartEdit:[],onItemEndEdit:[],onCreateItem:[],onItemMaxDepth:[],onItemSetParent:[],onItemUnsetParent:[]},paramsDataKey:"__sortable_params"};h.prototype={init:function(){var c=this,d=this.options;c.reset(),c.$placeholder=a('<div class="'+c.options.placeClass+'"/>'),a.each(this.$instance.find(c.options.itemNodeName),function(b,d){c.setParent(a(d))}),c.$instance.on("click","button",function(b){if(!c.$dragItem){var d=a(b.currentTarget),e=d.data("action"),f=d.parent(c.options.itemNodeName);"collapse"===e&&c.collapseItem(f),"expand"===e&&c.expandItem(f)}});var f=function(b){var d=a(b.target);if(!d.hasClass(c.options.handleClass)){if(d.closest(c.options.noDragClass.dot()).length)return;d=d.closest(c.options.handleClass.dot())}d.length&&!c.$dragItem&&(c.isTouch=/^touch/.test(b.type),c.isTouch&&1!==b.touches.length||(b.preventDefault(),c.dragStart(b.touches?b.touches[0]:b)))},g=function(a){c.$dragItem&&(a.preventDefault(),c.dragMove(a.touches?a.touches[0]:a))},h=function(a){c.$dragItem&&(a.preventDefault(),c.dragStop(a.touches?a.touches[0]:a))};e&&(c.$instance[0].addEventListener("touchstart",f,!1),b.addEventListener("touchmove",g,!1),b.addEventListener("touchend",h,!1),b.addEventListener("touchcancel",h,!1)),c.$instance.on("mousedown",f),c.w.on("mousemove",g),c.w.on("mouseup",h),d.addBtnSelector?this.addNewListItemListener(a(d.addBtnSelector)):this.addNewListItemListener(this.$instance.find(d.addBtnClass.dot()))},addNewListItemListener:function(b,c){var d=this,e=this.options;b.on("click",function(b){var c=d.$instance.find(e.listClass.dot()).first(),f=d.createNewListItem();f&&(f.css("display","none"),c.prepend(f),f.fadeIn(e.newItemFadeIn),d.options.event.onItemAdded.forEach(function(c,d){c(a(f),b)}))})},clickEndEditEventHandler:function(a){var b=this,c=b.options,d=a.find(c.endEditBtnClass.dot()).first();d.on("click",null,{forced:!0},b.keypressEnterEndEditEventHandler.bind(b))},clickStartEditEventHandler:function(b){var c=this.options,d=this,e=a(b.target).parents(c.itemClass.dot()).first(),f=e.find(c.itemNameClass.dot()).first(),g=e.find(c.inputSelector).first(),h=e.find(c.itemBtnContainerClass.dot()).first(),i=e.find(c.editBoxClass.dot()).first(),j=function(b){b.each(function(b,c){var c=a(c),e=d.keypressEnterEndEditEventHandler;c.data("sortable_keypressEnterEndEditEventHandler")||(c.data("sortable_keypressEnterEndEditEventHandler",!0),c.on("keypress",e.bind(d)))})};e.data("sortable_clickEndEditEventHandler")!==!0&&(d.clickEndEditEventHandler(e),e.data("sortable_clickEndEditEventHandler",!0)),f.stop().hide(c.slideAnimationDuration,function(){"SELECT"!==g.get(0).nodeName?g.val(f.text()):g.val(g.find("option:contains("+f.text()+")").val()),h.stop().hide(c.slideAnimationDuration,function(){i.stop().show(c.slideAnimationDuration,function(){i.children().first("input").select().focus(),j(e)})})}),c.event.onItemStartEdit.forEach(function(a,c){a(e,b)})},resolveToken:function(a,b){if("string"==typeof a){for(var c=a,d=/\{\?[a-z\-\.]+\}/gi,e=c.match(d),f=e&&e.length||0,g=0;g<f;g++)switch(e[g]){case"{?date.gregorian-slashed-DMY}":var h=new Date(Date.now()),i=h.getDay().toString().padLength("0",2)+"/"+h.getMonth().toString().padLength("0",2)+"/"+h.getFullYear();c=c.replace(e[g],i);break;case"{?date.mysql-datetime}":var i=new Date(Date.now());i=i.getUTCFullYear()+"-"+("00"+(i.getUTCMonth()+1)).slice(-2)+"-"+("00"+i.getUTCDate()).slice(-2)+" "+("00"+i.getUTCHours()).slice(-2)+":"+("00"+i.getUTCMinutes()).slice(-2)+":"+("00"+i.getUTCSeconds()).slice(-2),c=c.replace(e[g],i);break;case"{?numeric.increment}":this.incrementIncrement=this.incrementIncrement||1,c=c.replace(e[g],this.incrementIncrement),this.incrementIncrement+=1;break;case"{?value}":c=c.replace(e[g],b.value);break;default:c=a}return c}},saveEditBoxInput:function(b){var e,c=this,d=this.options;b.each(function(b,f){var g=a(f).parents(d.itemClass.dot().join(",").join(d.itemBlueprintClass.dot())).first().data(f.getAttribute("name")),h=a(f).data("default-value")||"";if(e=a(f).parents(d.itemClass.dot()).first(),!g&&!f.value)var i=c.resolveToken(h,a(f));e.data(f.getAttribute("name"),a(f).val()||g||i)}),d.event.onSaveEditBoxInput.forEach(function(a,c){a(e,b)})},keypressEnterEndEditEventHandler:function(b){var c=this,d=this.options,e=a(b.target).parents(d.itemClass.dot()).first(),f=e.find(d.editBoxClass.dot()).first(),g=e.find(d.inputSelector),h=e.find("span").first(),i=e.find(d.itemBtnContainerClass.dot()).first();(13===b.keyCode||b.data&&b.data.forced&&b.data.forced===!0)&&(c.determineAndSetItemTitle(e),""===h.text()&&h.text(c.determineAndSetItemTitle(e)),f.stop().slideUp(d.slideAnimationDuration,function(){c.saveEditBoxInput(g),i.attr("style",""),d.event.onItemEndEdit.forEach(function(c,d){c(a(e),b)}),h.stop().slideDown(d.slideAnimationDuration)}))},resolveInputDataEntryByName:function(b){var c=this.$instance;opt=this.options,c.find(opt.editBoxClass.dot().join(opt.inputSelector)).each(function(c,d){if(d.getAttribute("name")===b)return a(d).data("name")})},setItemTitle:function(a,b){var d=this.options;a.find(d.contentClass.dot().join("span")).first().text(b)},determineAndSetItemTitle:function(a){var b=this,c=this.options,d=a.find(c.inputSelector).first(),e=d.find("option:selected").first().text()||d.text(),f=a.find(c.editBoxClass.dot().eachHas(c.inputSelector)).first().val(),g=a.data(a.find(c.inputSelector).first().attr("name")),h=a.find(c.editBoxClass.dot().eachHas(c.inputSelector)).first().attr("placeholder"),i=a.find(c.editBoxClass.dot().eachHas(c.inputSelector)).first().data("placeholder"),j=e||f||g||b.resolveToken(i)||h;a.find(c.contentClass.dot().join("span")).first().text(j)},setInputCollectionPlaceholders:function(b,c){var d=this;a(c).each(function(c,e){if("SELECT"===e.nodeName){a(e).find('option[selected="selected"]').removeAttr("selected");var f=a(e).find('option[value="'+b.data(a(e).attr("name"))+'"]');if(0!==f.length)f.attr("selected","selected");else{if(!b.data(a(e).attr("name")))return;a(e).append('<option value="'+b.data(a(e).attr("name"))+'">'+b.data(a(e).attr("name"))+"</option>")}}a(e).attr("placeholder",d.resolveToken(a(e).data("placeholder"),a(e))||a(e).attr("placeholder")),a(e).val(b.data(a(e).attr("name")))})},createNewListItem:function(b){var c=this,d=this.$instance,e=this.options,f=d.find(e.itemBlueprintClass.dot()).first().clone(),g=f.find(e.editBoxClass.dot()).find(e.inputSelector);f.remove=function(){var a=f.parents(c.options.itemClass.dot()).first();jQuery(this).remove(),c.unsetEmptyParent(a),jQuery.each(e.event.onItemRemoved,function(a,b){b(f)})},f.setParameter=function(b,c){f.data(e.paramsDataKey,a.extend(!0,f.data(e.paramsDataKey),{key:c}))},f.getParameter=function(a){return f.data(a)},a.each(b||{},function(a,b){f.data(a,b)}),f.data("id",f.data("id")||c.getHighestId()+1);var h=f.attr("class"),i=e.itemClass+h.replace(e.itemBlueprintClass,"");return f.attr("class",i),this.setInputCollectionPlaceholders(f,g),this.saveEditBoxInput(g),this.determineAndSetItemTitle(f),this.setInputCollectionPlaceholders(g),f.find(e.removeBtnClass.dot()).first().on("click",function(b){var c=a(this),d=c.data(e.itemRemoveBtnConfirmClass);if(d)if(c.hasClass(d))f.remove();else{c.addClass(d);setTimeout(function(){c.removeClass(d)},e.refuseConfirmDelay)}else f.remove(),e.event.onItemRemoved.forEach(function(a,c){a(f,b)})}),f.find(e.itemAddBtnClass.dot()).first().on("click",function(a){c.itemAddChildItem(f),e.event.onItemAdded.forEach(function(b,c){b(f,a)}),e.event.onItemAddChildItem.forEach(function(b,c){b(f,a)})}),f.find("span").first().get(0).addEventListener("click",c.clickStartEditEventHandler.bind(this)),c.options.select2.support&&(f.find("select").css("width",c.options.select2.selectWidth),f.find("select").select2(c.options.select2.params)),f.data(e.paramsDataKey,f.data(e.paramsDataKey)||{}),e.event.onCreateItem.forEach(function(a,b){var c=a(f,f.data());f="undefined"==typeof c?f:c}),f},itemAddChildItem:function(b){var e,c=this,d=c.options,f=c.createNewListItem();if(f){if(b.parents(d.listClass.dot()).length>d.maxDepth){var g=b.find(d.itemAddBtnClass.dot());return g.addClass(d.removeBtnClass),setTimeout(function(){g.removeClass(d.removeBtnClass)},d.refuseConfirmDelay),void d.event.onItemMaxDepth.forEach(function(a,b){a()})}b.children(d.listClass.dot()).length?b.children(d.listClass.dot()).first().append(f):(e=a("<"+d.listNodeName+"/>").addClass(d.listClass),e.append(f),b.append(e)),c.setParent(b)}},getHighestId:function(){var b=this.options,c=this.$instance,d=0;return c.find(b.itemNodeName).each(function(b,c){var e=a(c).data("id");if(e>d)return d=e}),d},serialize:function(){this.options.event.onToJson.forEach(function(a,b){a()});var b,c=0,d=this;return step=function(b,c){var e=[],f=b.children(d.options.itemNodeName);return f.each(function(){var b=a(this),f=b.children(d.options.listNodeName),g={};a.each(b.data(),function(a,c){0!==a.indexOf("sortable_")&&(g[a]=b.data(a))});var h=a.extend({},g);f.length&&(h.children=step(f,c+1)),e.push(h)}),e},b=step(d.$instance.find(d.options.listNodeName).first(),c)},deserialize:function(b,c){var b=JSON.parse(b)||JSON.parse(this.options.data),d=this,e=this.options,f=d.$instance.find(e.listClass.dot()).first();c&&f.children().remove();var g=function(b,c){if(b.children){var f=a('<ol class="'+e.listClass+'"></ol>'),h=d.createNewListItem(b);if(!h)return;c.append(h),h.append(f),d.setParent(h,!0),jQuery.each(b.children,function(a,b){g(b,f)})}else{var h=d.createNewListItem(b);if(!h)return;c.append(h)}};jQuery.each(b,function(a,b){g(b,f)}),d.$instance.find(d.options.itemClass.dot()).each(function(b,c){a(c).data(d.options.paramsDataKey).collapsed&&d.collapseItem(a(c))}),this.options.event.onParseJson.forEach(function(a,b){a()})},serialise:function(){return this.serialize()},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,lastCurrentDistXChange:0,lastCurrentDistYChange:0,isMovingOnXAxis:null,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0,distXtotal:0,distYtotal:0},this.isTouch=!1,this.moving=!1,this.$dragItem=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.$pointEl=null},expandItem:function(b){b.removeClass(this.options.collapsedClass),b.children(this.options.listClass.dot()).children(this.options.itemClass.dot()).show(),b.children(this.options.expandBtnClass.dot()).hide(),b.children(this.options.collapseBtnClass.dot()).show(),b.data(this.options.paramsDataKey,a.extend(!0,b.data(this.options.paramsDataKey),{collapsed:!1})),this.options.event.onItemExpanded.forEach(function(a,c){a(b)})},collapseItem:function(b){b.addClass(this.options.collapsedClass),b.children(this.options.listClass.dot()).children(this.options.itemClass.dot()).hide(),b.children(this.options.collapseBtnClass.dot()).hide(),b.children(this.options.expandBtnClass.dot()).show(),b.data(this.options.paramsDataKey,a.extend(!0,b.data(this.options.paramsDataKey),{collapsed:!0})),this.options.event.onItemCollapsed.forEach(function(a,c){a(b)})},expandAll:function(b){var c=this,d=function(e){if(b&&b(e)){c.expandItem(e);var f=e.children(c.options.listNodeName);f.length&&jQuery.each(f,function(b,c){d(a(c))})}};c.$instance.find(this.options.collapsedClass.dot()).each(function(b,c){d(a(c))})},collapseAll:function(b){var c=this,d=function(e){if(b&&b(e)){var f=e.children(c.options.listNodeName);f.length&&(c.collapseItem(e),jQuery.each(f,function(b,c){d(a(c))}))}};c.$instance.find(c.options.listNodeName).children(c.options.itemClass.dot()).each(function(b,c){d(a(c))})},setParent:function(a,b){var c=this.options;if(a.children(this.options.listNodeName).length||b){a.children('[data-action="collapse"]').show();var d=a.find(this.options.handleClass.dot()).first().clone();a.find(this.options.handleClass.dot()).first().remove(),a.prepend(d)}a.children('[data-action="expand"]').hide(),c.event.onItemSetParent.forEach(function(b,c){b(a)})},unsetParent:function(a){var b=this.options;a.removeClass(this.options.collapsedClass),a.children("[data-action]").hide(),a.children(this.options.listNodeName).remove(),a.removeData("children"),b.event.onItemUnsetParent.forEach(function(b,c){b(a,d)})},unsetEmptyParent:function(a){var b=this;0===a.find(this.options.itemClass.dot()).length&&b.unsetParent(a)},getChildrenCount:function(a){return a.parents(this.options.listClass.dot()).length+this.$dragItem.find(this.options.listClass.dot()).length-1},updatePlaceholderMaxDepthApperance:function(){this.getChildrenCount(this.$placeholder)>=this.options.maxDepth?this.$placeholder.addClass("max-depth"):this.$placeholder.removeClass("max-depth")},dragStart:function(b){var e=this.mouse,f=this.options,g=a(b.target),h=g.closest(this.options.itemNodeName);h.attr("class").match(f.noDragClass)||(this.$placeholder.css("height",h.height()),e.offsetX=b.offsetX!==d?b.offsetX:b.pageX-g.offset().left,e.offsetY=b.offsetY!==d?b.offsetY:b.pageY-g.offset().top,e.startX=e.lastX=b.pageX,e.startY=e.lastY=b.pageY,this.dragRootEl=this.$instance,this.$dragItem=a(c.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.$dragItem.css("width",h.width()),h.after(this.$placeholder),h[0].parentNode.removeChild(h[0]),h.appendTo(this.$dragItem),a(c.body).append(this.$dragItem),this.$dragItem.css({left:b.pageX-e.offsetX,top:b.pageY-e.offsetY}),this.updatePlaceholderMaxDepthApperance(),this.options.event.onItemDrag.forEach(function(c,d){c(a(h),b)}))},dragStop:function(b){var c=this.$dragItem.children(this.options.itemNodeName).first();c[0].parentNode.removeChild(c[0]),this.$placeholder.replaceWith(c),this.$dragItem.remove(),this.$instance.trigger("change"),this.hasNewRoot&&this.dragRootEl.trigger("change"),this.reset(),this.mouse.distXtotal=0,this.mouse.distYtotal=0,this.options.event.onItemDrop.forEach(function(d,e){d(a(c),b)}),a(c).parents(this.options.rootClass).data("sortable-id")!==a(this.$instance).data("sortable-id")&&a(c).parents(this.options.rootClass.dot()).sortable()._plugin.options.event.onItemDrop.forEach(function(a,d){a(c,b)})},dragMove:function(d){function t(a,b){o.distXtotal=a,o.distYtotal=b,0==a&&(o.lastX=o.startX=o.nowX),0==b&&(o.lastY=o.startY=o.nowY)}var j,k,l,n=this.options,o=this.mouse;o.lastX=o.nowX||d.pageX,o.lastY=o.nowY||d.pageY,o.nowX=d.pageX,o.nowY=d.pageY,o.lastCurrentDistXChange=o.nowX-o.lastX,o.lastCurrentDistYChange=o.nowY-o.lastY,o.lastDirX=o.dirX,o.lastDirY=o.dirY,o.dirX=0===o.lastCurrentDistXChange?0:o.lastCurrentDistXChange>0?1:-1,o.dirY=0===o.lastCurrentDistYChange?0:o.lastCurrentDistYChange>0?1:-1;var p=Math.abs(this.$placeholder.offset().top-this.$dragItem.offset().top),q=Math.abs(this.$placeholder.offset().left-this.$dragItem.offset().left),r=2/Math.PI*Math.atan(Math.PI/2*(p+q)*.1/n.threshold);if(this.$dragItem.css({left:d.pageX-o.offsetX,top:d.pageY-o.offsetY}),this.$pointEl=a(c.elementFromPoint(d.pageX-c.body.scrollLeft,d.pageY-(b.pageYOffset||c.documentElement.scrollTop))),k=this.$pointEl.closest(n.rootClass.dot()),l=this.dragRootEl.data("sortable-id")!==k.data("sortable-id"),k.length&&!l?this.$placeholder.css({opacity:1}):this.$placeholder.css({opacity:1-r}),!(0===k.length&&r>.4)){var s=Math.abs(o.lastCurrentDistXChange)>Math.abs(o.lastCurrentDistYChange)&&Math.abs(o.lastCurrentDistXChange-o.lastCurrentDistYChange)>2;if(o.moving===!1&&(o.isMovingOnXAxis=s,o.moving=!0),t(o.nowX-o.startX,o.nowY-o.startY),o.isMovingOnXAxis=s,this.updatePlaceholderMaxDepthApperance(),0===this.$pointEl.parents(n.rootClass.dot()).length&&t(0,0),Math.abs(o.distXtotal)>=n.threshold){var u=this.$placeholder.prev(n.itemNodeName),v=u.find(n.listNodeName).last();if(o.distXtotal>0&&1===o.dirX&&u.length>0&&!u.hasClass(n.collapsedClass))if(this.getChildrenCount(this.$placeholder)<n.maxDepth)if(v.length>0){var w=u.children(n.listNodeName).last();w.append(this.$placeholder),t(0,0)}else{var x=a(c.createElement(n.listNodeName)).addClass(n.listClass);x.append(this.$placeholder),u.append(x),this.setParent(u),t(0,0)}else this.getChildrenCount(this.$placeholder)>=n.maxDepth&&(this.updatePlaceholderMaxDepthApperance(),n.event.onItemMaxDepth.forEach(function(a,b){a(u)}));else if(o.distXtotal<0&&o.dirX===-1){var y=this.$placeholder.parents(n.itemClass.dot()).first();y.length&&(y.after(this.$placeholder),0===y.children(n.itemClass.dot()).length&&this.unsetEmptyParent(y),t(0,0))}}if(f||(this.$dragItem[0].style.visibility="hidden"),this.$instance.children(this.options.listClass.dot()).length||this.$instance.append(a("<"+this.options.listNodeName+"/>").attr("class",this.options.listClass)),this.options.allowListMerging!==!0){if(l&&this.options.allowListMerging===!1)return;if(l&&k.data("sortable")&&k.data("sortable").options.allowListMerging.indexOf(this.$instance.attr("id"))===-1)return}if(this.$pointEl.hasClass(n.listClass)&&!this.$pointEl.children(n.itemClass.dot()).length&&this.$pointEl.append(this.$placeholder),this.$pointEl.parents(n.rootClass.dot()).length&&!this.$pointEl.hasClass(n.listClass)&&!this.$pointEl.hasClass(n.placeClass)){if(this.$pointEl.hasClass(n.itemClass)||(this.$pointEl=a(this.$pointEl).parents(n.itemClass.dot()).first()),f||(this.$dragItem[0].style.visibility="visible"),this.$pointEl.hasClass(n.handleClass))this.$pointEl=this.$pointEl.parent(n.itemNodeName);else if(!this.$pointEl.length||!this.$pointEl.hasClass(n.itemClass))return;if(o.isMovingOnXAxis===!1&&Math.abs(o.distYtotal)>=5){if(l&&n.allowListMerging===!1)return;if(l&&"object"==typeof n.allowListMerging&&n.allowListMerging.indexOf(k.attr("id"))===-1)return;t(0,0);var j=this.dragDepth-1+this.$pointEl.parents(n.listNodeName).length,z=this.$placeholder.parent();j>n.maxDepth&&n.event.onItemMaxDepth.forEach(function(a,b){a(this.$dragItem)});var A=d.pageY<this.$pointEl.offset().top+this.$pointEl.height()/2;if(this.$pointEl.hasClass(n.emptyClass)){var x=a(c.createElement(n.listNodeName)).addClass(n.listClass);x.append(this.$placeholder),this.$pointEl.replaceWith(x)}else A&&z!==this.$pointEl?this.$pointEl.before(this.$placeholder):o.dirY>0&&z!==this.$pointEl&&this.$pointEl.after(this.$placeholder);0===z.children().length&&this.unsetEmptyParent(z.parent()),0===this.dragRootEl.find(n.itemNodeName).length&&this.dragRootEl.append('<div class="'+n.emptyClass+'"/>'),l&&(this.dragRootEl=k,this.hasNewRoot=this.$instance[0]!==this.dragRootEl[0])}}}}},i.prototype={getLists:function(){return this._lists},parseJson:function(a,b){var a=a||null,b=b||!1;return this._plugin.deserialize(a,b),this},toJson:function(){var a=this._plugin.serialize();return JSON.stringify(a)},expandAll:function(){return this._plugin.expandAll(function(){return!0}),this},collapseAll:function(){return this._plugin.collapseAll(function(){return!0}),this},expand:function(a){return this._plugin.expandAll(a),this},collapse:function(a){return this._plugin.collapseAll(a),this},onParseJson:function(a){var b=this;return b._plugin.options.event.onParseJson.push(a.bind(b)),b},onItemSetParent:function(a){var b=this;return b._plugin.options.event.onItemSetParent.push(a.bind(b)),b},onItemUnsetParent:function(a){var b=this;return b._plugin.options.event.onItemUnsetParent.push(a.bind(b)),b},onToJson:function(a){var b=this;return b._plugin.options.event.onToJson.push(a.bind(b)),b},onSaveEditBoxInput:function(a){var b=this;return b._plugin.options.event.onSaveEditBoxInput.push(a.bind(b)),b},onItemDrag:function(a){var b=this;return b._plugin.options.event.onItemDrag.push(a.bind(b)),b},onItemDrop:function(a){var b=this;return b._plugin.options.event.onItemDrop.push(a.bind(b)),b},onItemAdded:function(a){var b=this;return b._plugin.options.event.onItemAdded.push(a.bind(b)),b},onItemRemoved:function(a){var b=this;return this._plugin.options.event.onItemRemoved.push(a.bind(b)),b},onItemStartEdit:function(a){var b=this;return this._plugin.options.event.onItemStartEdit.push(a.bind(b)),b},onItemEndEdit:function(a){var b=this;return this._plugin.options.event.onItemEndEdit.push(a.bind(b)),b},onItemAddChildItem:function(a){var b=this;return this._plugin.options.event.onItemAddChildItem.push(a.bind(b)),b},onCreateItem:function(a){var b=this;return this._plugin.options.event.onCreateItem.push(a.bind(b)),b},onItemCollapsed:function(a){var b=this;return this._plugin.options.event.onItemCollapsed.push(a.bind(b)),b},onItemExpanded:function(a){var b=this;return this._plugin.options.event.onItemExpanded.push(a.bind(b)),b},onItemMaxDepth:function(a){var b=this;return this._plugin.options.event.onItemMaxDepth.push(a.bind(b)),b},on:function(a,b){var c=this;return"object"==typeof a?a.forEach(function(a,d){c._plugin.options.event[a].push(b.bind(c))}):"*"===a?Object.keys(c._plugin.options.event).forEach(function(a,d){c._plugin.options.event[a].push(b.bind(c))}):"string"==typeof a&&c._plugin.options.event[a].push(b.bind(c)),c},getListNodes:function(){var a=this._plugin.options,b=this._plugin.$instance.find(a.listNodeName);return b},getPluginOptions:function(){return this._plugin.options}},a.fn.sortable=function(b){var c=this.first(),d=a(this),e=d.data("sortable")||new h(this,b),f=new i(e,c);if(b&&(e.options=a.extend(!0,{},g,b)),d.data("sortable")&&!b||d.data("sortable",e),!d.data("sortable-id")){var j=Math.random().toString().replace(/\D/g,"");d.data("sortable-id",j)}return f||e}}(window.jQuery||window.Zepto,window,document);